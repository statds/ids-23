<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science - 8&nbsp; Statistical Tests and Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./visual.html" rel="next">
<link href="./descr.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Statistical Tests and Models</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Project Management with Git</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducibile Data Science with Quarto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Python Refreshment</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Manipulation with Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geo.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Geospatial Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Statistical Tests and Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visual.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./supervised.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Supervised Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./advanced.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Topics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nyccrash.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">NYC Crash Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Exercises</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#tests-for-exploratory-data-analysis" id="toc-tests-for-exploratory-data-analysis" class="nav-link active" data-scroll-target="#tests-for-exploratory-data-analysis"><span class="toc-section-number">8.1</span>  Tests for Exploratory Data Analysis</a></li>
  <li><a href="#statistical-functions-from-scypy.stat" id="toc-statistical-functions-from-scypy.stat" class="nav-link" data-scroll-target="#statistical-functions-from-scypy.stat"><span class="toc-section-number">8.2</span>  Statistical Functions from <code>scypy.stat</code></a>
  <ul class="collapse">
  <li><a href="#discrete-variables" id="toc-discrete-variables" class="nav-link" data-scroll-target="#discrete-variables"><span class="toc-section-number">8.2.1</span>  Discrete Variables</a></li>
  <li><a href="#continuous-variables" id="toc-continuous-variables" class="nav-link" data-scroll-target="#continuous-variables"><span class="toc-section-number">8.2.2</span>  Continuous Variables</a></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="toc-section-number">8.2.3</span>  Summary Statistics</a></li>
  <li><a href="#frequency-statistics" id="toc-frequency-statistics" class="nav-link" data-scroll-target="#frequency-statistics"><span class="toc-section-number">8.2.4</span>  Frequency Statistics</a></li>
  <li><a href="#statistical-tests" id="toc-statistical-tests" class="nav-link" data-scroll-target="#statistical-tests"><span class="toc-section-number">8.2.5</span>  Statistical Tests</a></li>
  <li><a href="#nyc-crash-data-examples" id="toc-nyc-crash-data-examples" class="nav-link" data-scroll-target="#nyc-crash-data-examples"><span class="toc-section-number">8.2.6</span>  NYC crash data examples</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">8.2.7</span>  REFERENCES</a></li>
  </ul></li>
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model"><span class="toc-section-number">8.3</span>  Linear Model</a></li>
  <li><a href="#generalized-linear-regression" id="toc-generalized-linear-regression" class="nav-link" data-scroll-target="#generalized-linear-regression"><span class="toc-section-number">8.4</span>  Generalized Linear Regression</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Statistical Tests and Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="tests-for-exploratory-data-analysis" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="tests-for-exploratory-data-analysis"><span class="header-section-number">8.1</span> Tests for Exploratory Data Analysis</h2>
<p>A collection of functions are available from <code>scipy.stats</code>.</p>
<ul>
<li>Comparing the locations of two samples
<ul>
<li><code>ttest_ind</code>: t-test for two independent samples</li>
<li><code>ttest_rel</code>: t-test for paired samples</li>
<li><code>ranksums</code>: Wilcoxon rank-sum test for two independent samples</li>
<li><code>wilcoxon</code>: Wilcoxon signed-rank test for paired samples</li>
</ul></li>
<li>Comparing the locations of multiple samples
<ul>
<li><code>f_oneway</code>: one-way ANOVA</li>
<li><code>kruskal</code>: Kruskal-Wallis H-test</li>
</ul></li>
<li>Tests for associations in contigency tables
<ul>
<li><code>chi2_contingency</code>: Chi-square test of independence of variables</li>
<li><code>fisher_exact</code>: Fisher exact test on a 2x2 contingency table</li>
</ul></li>
<li>Goodness of fit
<ul>
<li><code>goodness_of_fit</code>: distribution could contain unspecified parameters</li>
<li><code>anderson</code>: Anderson-Darling test</li>
<li><code>kstest</code>: Kolmogorov-Smirnov test</li>
<li><code>chisquare</code>: one-way chi-square test</li>
<li><code>normaltest</code>: test for normality</li>
</ul></li>
</ul>
<p>Since R has a richer collections of statistical functions, we can call R function from Python with <code>rpy2</code>. See, for example, a <a href="https://rviews.rstudio.com/2022/05/25/calling-r-from-python-with-rpy2/">blog on this subject</a>.</p>
<p>For example, <code>fisher_exact</code> can only handle 2x2 contingency tables. For contingency tables larger than 2x2, we can call <code>fisher.text()</code> from R through <code>rpy2</code>. See <a href="https://stackoverflow.com/questions/25368284/fishers-exact-test-for-bigger-than-2-by-2-contingency-table">this StackOverflow post</a>. Note that the <code>.</code> in function names and arguments are replaced with <code>_</code>.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2.robjects.numpy2ri</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>rpy2.robjects.numpy2ri.activate()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> importr(<span class="st">'stats'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>jan23 <span class="op">=</span> pd.read_csv(<span class="st">"data/nyc_crashes_202301.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>jan23[<span class="st">"injury"</span>] <span class="op">=</span> np.where(jan23[<span class="st">"NUMBER OF PERSONS INJURED"</span>] <span class="op">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> pd.crosstab(jan23[<span class="st">"injury"</span>], jan23[<span class="st">"BOROUGH"</span>])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stats.fisher_test(m.to_numpy(), simulate_p_value <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">0</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading custom .Rprofile</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>BOROUGH  BRONX  BROOKLYN  MANHATTAN  QUEENS  STATEN ISLAND
injury                                                    
0          526       999        528     801            126
1          295       654        283     515             69</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0.09995002498750624</code></pre>
</div>
</div>
<!-- ## scypy statistics functions -->
</section>
<section id="statistical-functions-from-scypy.stat" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="statistical-functions-from-scypy.stat"><span class="header-section-number">8.2</span> Statistical Functions from <code>scypy.stat</code></h2>
<p>Colin Sullivan</p>
<p>The <code>scipy.stats</code> module is a <code>SciPy</code> sub-package used for probabilistic distributions and general statistical operations. <code>SciPy</code>, the parent module, is one of the largest and most well known packages available for Python, which deals with common science and engineering problems.</p>
<p>First, you will need to install scipy on your computer. To do so, use one of the following commands:</p>
<pre><code>python -m pip install scipy</code></pre>
<p>or</p>
<pre><code>conda install scipy</code></pre>
<p>depending on which tool you prefer. Then, you will need to import scipy.stats at the beginning of each python file like so:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are three different classes available in scipy.stats:</p>
<ul>
<li><p><code>rv_continous</code>, for continuous random variables</p></li>
<li><p><code>rv_discrete</code>, for discrete random variables</p></li>
<li><p><code>rv_histogram</code>, used to generate specific distribution histograms</p></li>
</ul>
<section id="discrete-variables" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="discrete-variables"><span class="header-section-number">8.2.1</span> Discrete Variables</h3>
<p>First, lets talk about discrete variables. The default initialization variables are as folows:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>stats.rv_discrete(a<span class="op">=</span><span class="dv">0</span>, b<span class="op">=</span><span class="va">None</span>, name<span class="op">=</span><span class="va">None</span>, badvalue<span class="op">=</span><span class="va">None</span>, moment_tol<span class="op">=</span><span class="fl">1e-08</span>, values<span class="op">=</span><span class="va">None</span>, inc<span class="op">=</span><span class="dv">1</span>, longname<span class="op">=</span><span class="va">None</span>, shapes<span class="op">=</span><span class="va">None</span>, extradoc<span class="op">=</span><span class="va">None</span>, seed<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>&lt;scipy.stats._distn_infrastructure.rv_discrete at 0x117d9ea90&gt;</code></pre>
</div>
</div>
<ul>
<li><p><code>a</code>, <code>b</code> are floats representing the lower and upper bound of the distribution, respectively.</p></li>
<li><p><code>name</code> represents the name of the distribution, which is optional.</p></li>
<li><p><code>badvalue</code> is used to indicate a value for which some argument restriction is violated.</p></li>
<li><p><code>moment_tol</code> is the tolerance for calculations of moments.</p></li>
<li><p><code>values</code> is a tuple of arrays of equal length, one representing integers and one representing their probability.</p></li>
<li><p><code>inc</code> is the increment for the support of the distribution.</p></li>
<li><p><code>longname</code> is used to provide a line for the docstring if you are creating a class without one.</p></li>
<li><p><code>shapes</code> represents the shape of the distribution. If no values are provided here it will default to the pmf and cdf.</p></li>
<li><p><code>extradoc</code> is the last line for the docstring given in longname.</p></li>
<li><p><code>seed</code> represents a random seed. If none is provided, scipy.stats’ default random seed will be used.</p></li>
</ul>
<p>You can build your own discrete variables by defining their pdf and cdf using classes. An example is shown below for a 4 sided die:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> four_die(stats.rv_discrete):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _pmf(<span class="va">self</span>, x):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> <span class="bu">list</span>([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x.tolist() <span class="kw">in</span> lst:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _cdf(<span class="va">self</span>, x):</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x <span class="op">&lt;</span> <span class="dv">1</span>:</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> x <span class="op">&gt;=</span> <span class="dv">4</span>:</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (x <span class="op">//</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _stats(<span class="va">self</span>):</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        mean <span class="op">=</span> np.mean([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        var <span class="op">=</span> np.var([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], ddof<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        std <span class="op">=</span> np.sqrt(var)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> mean, var, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>die <span class="op">=</span> four_die()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then test your new variable using scipy.stats build in functions.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(die.rvs(size<span class="op">=</span><span class="dv">10</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(die.mean())</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(die.var())</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(die.std())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 1 1 1 3 3 4 2 3 3]
2.5
1.25
1.118033988749895</code></pre>
</div>
</div>
<p>The above is used to define your own discrete random variable. Scipy.stats has many built in already, including common ones such as:</p>
<ul>
<li>Bernoulli – scipy.stats.bernoulli</li>
</ul>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.5</span> <span class="co">## shape parameter, prob of a single success</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(stats.bernoulli.ppf(<span class="fl">0.01</span>, a), stats.bernoulli.ppf(<span class="fl">0.99</span>, a))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.bernoulli(a)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pmf(x), ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, rv.pmf(x), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-7-output-1.png" width="571" height="411"></p>
</div>
</div>
<ul>
<li>Binomial – scipy.stats.binom</li>
</ul>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">5</span> <span class="co">## number of trials</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.5</span> <span class="co">## shape parameter, prob of a single success</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(stats.binom.ppf(<span class="fl">0.01</span>, n, a), stats.binom.ppf(<span class="fl">0.99</span>, n, a))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.binom(n, a)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pmf(x), ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, rv.pmf(x), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-8-output-1.png" width="579" height="411"></p>
</div>
</div>
<ul>
<li>Geometric – scipy.stats.geom</li>
</ul>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">5</span> <span class="co">## number of trials</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.5</span> <span class="co">## shape parameter, prob of a single success</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(stats.geom.ppf(<span class="fl">0.01</span>, a), stats.geom.ppf(<span class="fl">0.99</span>, a))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.geom(a)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pmf(x), ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, rv.pmf(x), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-9-output-1.png" width="571" height="411"></p>
</div>
</div>
<ul>
<li>Hyper Geometric – scipy.stats.hypergeom</li>
</ul>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">50</span> <span class="co">## number of objects</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">17</span> <span class="co">## number of type x objects</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="dv">35</span> <span class="co">## number of type x objects drawn</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.5</span> <span class="co">## shape parameter, prob of a single success</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">=</span> np.arange(<span class="dv">0</span>, n<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.hypergeom(m, n, n2)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pmf(x), ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, rv.pmf(x), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-10-output-1.png" width="584" height="411"></p>
</div>
</div>
<ul>
<li>Poisson – scipy.stats.poisson</li>
</ul>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">0.5</span> <span class="co">## mean, shape parameter</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(stats.poisson.ppf(<span class="fl">0.01</span>, a), stats.poisson.ppf(<span class="fl">0.99</span>, a))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.poisson(a)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pmf(x), ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, rv.pmf(x), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-11-output-1.png" width="571" height="411"></p>
</div>
</div>
<ul>
<li>Uniform – scipy.stats.randint</li>
</ul>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">8</span> <span class="co">## low</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">40</span> <span class="co">## high</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(stats.randint.ppf(<span class="fl">0.01</span>, a, b), stats.randint.ppf(<span class="fl">0.99</span>, a, b))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.randint(a, b)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pmf(x), ms<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, rv.pmf(x), alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-12-output-1.png" width="587" height="411"></p>
</div>
</div>
<p>All of these different random variables, including ones that you choose to define yourself, can be used with all of scipy.stats’ operations which will be discussed later.</p>
</section>
<section id="continuous-variables" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="continuous-variables"><span class="header-section-number">8.2.2</span> Continuous Variables</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>stats.rv_continuous(momtype<span class="op">=</span><span class="dv">1</span>, a<span class="op">=</span><span class="va">None</span>, b<span class="op">=</span><span class="va">None</span>, xtol<span class="op">=</span><span class="fl">1e-14</span>, badvalue<span class="op">=</span><span class="va">None</span>, name<span class="op">=</span><span class="va">None</span>, longname<span class="op">=</span><span class="va">None</span>, shapes<span class="op">=</span><span class="va">None</span>, extradoc<span class="op">=</span><span class="va">None</span>, seed<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>&lt;scipy.stats._distn_infrastructure.rv_continuous at 0x121192710&gt;</code></pre>
</div>
</div>
<p>Similarly:</p>
<ul>
<li><p>a, b are floats representing the lower and upper bound of the distribution, respectively.</p></li>
<li><p>name represents the name of the distribution, which is optional.</p></li>
<li><p>badvalue is used to indicate a value for which some argument restriction is violated.</p></li>
<li><p>xtol is the tolerance for fixed point calculations of generic ppf.</p></li>
<li><p>values is a tuple of arrays of equal length, one representing integers and one representing their probability.</p></li>
<li><p>momtype is the type of generic moment calculation to use.</p></li>
<li><p>longname is used to provide a line for the docstring if you are creating a class without one.</p></li>
<li><p>shapes represents the shape of the distribution. If no values are provided here it will default to the pmf and cdf.</p></li>
<li><p>extradoc is the last line for the docstring given in longname.</p></li>
<li><p>seed represents a random seed. If none is provided, scipy.stats’ default random seed will be used.</p></li>
</ul>
<p>We can define our own continuous variable of student grades using this rv_continous method.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> test_grades(stats.rv_continuous):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _pdf(<span class="va">self</span>, x, mu, sigma):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> stats.norm.pdf(x, mu, sigma)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _cdf(<span class="va">self</span>, x, mu, sigma):</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> stats.norm.cdf(x, mu, sigma)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _ppf(<span class="va">self</span>, q, mu, sigma):</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> stats.norm.ppf(q, mu, sigma)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _rvs(<span class="va">self</span>, mu, sigma, size):</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> stats.norm.rvs(mu, sigma, size<span class="op">=</span>size)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>grades <span class="op">=</span> test_grades()</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">75</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># samples = grades.rvs(mu, sigma, size=size)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean grade: "</span>, grades.mean(mu, sigma))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Standard deviation of grades: "</span>, grades.std(mu, sigma))</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"95th percentile: "</span>, grades.ppf(<span class="fl">0.95</span>, mu, sigma))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean grade:  75.0
Standard deviation of grades:  10.0000000001417
95th percentile:  91.44853626951472</code></pre>
</div>
</div>
<p>Again similarly, there are many built in continuous variable distributions that you can use, such as:</p>
<ul>
<li>Alpha – scipy.stats.alpha</li>
</ul>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">3.57</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(stats.alpha.ppf(<span class="fl">0.01</span>, a), stats.alpha.ppf(<span class="fl">0.99</span>, a), <span class="dv">100</span>) <span class="co">## create PDF</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.alpha(a) <span class="co">## initialize alpha rv</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pdf(x), <span class="st">'k-'</span>, lw<span class="op">=</span><span class="dv">2</span>) <span class="co">## plot pdf</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-15-output-1.png" width="558" height="411"></p>
</div>
</div>
<ul>
<li>Beta – scipy.stats.beta</li>
</ul>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="fl">2.31</span>, <span class="fl">0.627</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(stats.beta.ppf(<span class="fl">0.01</span>, a, b), stats.beta.ppf(<span class="fl">0.99</span>, a, b), <span class="dv">100</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.beta(a, b)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pdf(x), <span class="st">'k-'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-16-output-1.png" width="566" height="411"></p>
</div>
</div>
<ul>
<li>Chi Squared – scipy.stats.chi2</li>
</ul>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">100</span> <span class="co">## degrees of freedom</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(stats.chi2.ppf(<span class="fl">0.01</span>, a), stats.chi2.ppf(<span class="fl">0.99</span>, a), <span class="dv">100</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.chi2(a)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pdf(x), <span class="st">'k-'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-17-output-1.png" width="587" height="411"></p>
</div>
</div>
<ul>
<li>Exponential – scipy.stats.expon</li>
</ul>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(stats.expon.ppf(<span class="fl">0.01</span>), stats.expon.ppf(<span class="fl">0.99</span>), <span class="dv">100</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.expon() <span class="co">## takes no arguments</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pdf(x), <span class="st">'k-'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-18-output-1.png" width="571" height="411"></p>
</div>
</div>
<ul>
<li>Gamma – scipy.stats.gamma</li>
</ul>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span> <span class="co">## shape parameter</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(stats.gamma.ppf(<span class="fl">0.01</span>, a), stats.gamma.ppf(<span class="fl">0.99</span>, a), <span class="dv">100</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.gamma(a)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pdf(x), <span class="st">'k-'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-19-output-1.png" width="579" height="411"></p>
</div>
</div>
<ul>
<li>Uniform – scipy.stats.uniform</li>
</ul>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(stats.uniform.ppf(<span class="fl">0.01</span>), stats.uniform.ppf(<span class="fl">0.99</span>), <span class="dv">100</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>rv <span class="op">=</span> stats.uniform()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ax.plot(x, rv.pdf(x), <span class="st">'k-'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-20-output-1.png" width="579" height="411"></p>
</div>
</div>
</section>
<section id="summary-statistics" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">8.2.3</span> Summary Statistics</h3>
<p>When examining data, often you want to find different summary statistics before beginning statistical tests.</p>
<p>There are several built in methods to do so. First, lets take a look at describe:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>array1 <span class="op">=</span> np.random.randint(<span class="dv">1</span>,<span class="dv">101</span>,<span class="dv">10</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stats.describe(array1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[40 44 29 37  4 88 96  8 58 26]
DescribeResult(nobs=10, minmax=(4, 96), mean=43.0, variance=926.2222222222223, skewness=0.5537853453764205, kurtosis=-0.7004798003986137)</code></pre>
</div>
</div>
<p>The describe method returns a number of summary statistics: length of array, a tuple containing the min and the max, the mean and variance, the skewness, and kurtosis, which is the measure of tailedness in the data. There are a number of optional parameters in describe that can change how our results are found:</p>
<ul>
<li><p>ddof – delta degrees of freedom, integer.</p></li>
<li><p>bias – boolean variable with default value True. If False, skewness and kurtosis are corrected for statistical biases.</p></li>
<li><p>nan_policy – options are {‘propogate’, ‘raise’, ‘omit’}, and they tell the method how to deal with NaN values. Propogate returns NaN, raise throws an error, and omit skips the value in the array.</p></li>
</ul>
<p>We can also compute statistics of trimmed data, if we do not want to alter the dataset. For example, let’s say we only want to see the values between 20 and 80.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Trimmed mean: "</span> <span class="op">+</span> <span class="bu">str</span>(stats.tmean(array1, (<span class="dv">20</span>, <span class="dv">80</span>))))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Trimmed standard deviation: "</span> <span class="op">+</span> <span class="bu">str</span>(stats.tstd(array1, (<span class="dv">20</span>, <span class="dv">80</span>))))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trimmed mean: 39.0
Trimmed standard deviation: 11.489125293076057
[40 44 29 37  4 88 96  8 58 26]</code></pre>
</div>
</div>
<p>As you can see, the array remains unchanged but we find a new mean and standard deviation with the values trimmed. Similar functions can be used:</p>
<ul>
<li><p>tvar – takes array and limit tuple, returns trimmed variance</p></li>
<li><p>tsem – takes array and limit tuple, returns trimmed standard error</p></li>
<li><p>tmin – takes array and minimum limit, returns new minimum value above trimmed limit</p></li>
<li><p>tmax – takes array and maximum limit, returns new maximum value below trimmed limit</p></li>
</ul>
<p>Further functions include iqr to compute the interquartile range of the data and sem which computes the standard error of the mean.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"IQR: "</span> <span class="op">+</span> <span class="bu">str</span>(stats.iqr(array1)))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Std Error of the Mean: "</span> <span class="op">+</span> <span class="bu">str</span>(stats.sem(array1)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR: 27.75
Std Error of the Mean: 9.624043964063247</code></pre>
</div>
</div>
</section>
<section id="frequency-statistics" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="frequency-statistics"><span class="header-section-number">8.2.4</span> Frequency Statistics</h3>
<p>There are several methods in scipy.stats related to frequency statistics. Relfreq and Cumfreq are used to create a relative frequency and cumulative frequency histogram, respectively. This can provide more insight on the data then a regular histogram would. An example is demonstrated below.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> plt</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Create an array of grades with frequency of 0.2 for 90, 0.3 for 80, and so on</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>poss_grades <span class="op">=</span> [<span class="dv">90</span>, <span class="dv">80</span>, <span class="dv">70</span>, <span class="dv">60</span>, <span class="dv">50</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>grades <span class="op">=</span> np.random.choice(poss_grades, <span class="dv">100</span>, p<span class="op">=</span>[<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grades)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Use cumfreq to find our variables for the Cumulative Histogram</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stats.cumfreq(grades, numbins<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> res.lowerlimit <span class="op">+</span> np.linspace(<span class="dv">0</span>, res.binsize<span class="op">*</span>res.cumcount.size,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                                 res.cumcount.size)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Use relfreq to find our variables for the Relative Histogram</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>res2 <span class="op">=</span> stats.relfreq(grades, numbins<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> res2.lowerlimit <span class="op">+</span> np.linspace(<span class="dv">0</span>, res2.binsize<span class="op">*</span>res2.frequency.size,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                                 res2.frequency.size)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot normal histogram vs our 2 special ones</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>ax1.hist(grades, bins<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Histogram'</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>ax2.bar(x, res.cumcount, width<span class="op">=</span>res.binsize)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Cumulative histogram'</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim([x.<span class="bu">min</span>(), x.<span class="bu">max</span>()])</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>ax3.bar(x2, res2.frequency, width<span class="op">=</span>res2.binsize)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Relative frequency histogram'</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>ax3.set_xlim([x2.<span class="bu">min</span>(), x2.<span class="bu">max</span>()])</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[90 80 60 70 70 80 70 70 60 80 50 90 90 80 50 50 90 80 80 70 80 60 60 80
 90 80 70 50 80 80 50 70 60 60 80 70 70 60 50 50 90 70 70 70 80 90 70 60
 50 80 80 70 80 50 90 80 80 50 50 80 80 80 80 80 80 60 90 50 90 70 80 70
 80 90 60 90 70 90 70 90 90 90 50 70 80 90 70 90 80 70 50 70 60 50 80 80
 80 80 80 80]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-24-output-2.png" width="798" height="357"></p>
</div>
</div>
<p>There are also two methods to use when checking percentile ranks:</p>
<ul>
<li><p>percentileofscore – takes an array and a score as input, returns the percentile rank of the score</p></li>
<li><p>scoreatpercentile – takes an array and a percentile as input, returns the score at that percentile</p></li>
</ul>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>array2 <span class="op">=</span> np.random.randint(<span class="dv">1</span>,<span class="dv">101</span>,<span class="dv">100</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array2)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The percentile of the score 90 is: "</span> <span class="op">+</span> <span class="bu">str</span>(stats.percentileofscore(array2, <span class="dv">90</span>)))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Score at the 90th percentile is: "</span> <span class="op">+</span> <span class="bu">str</span>(stats.scoreatpercentile(array2, <span class="dv">90</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[71 65 98 88  6 21  9 90 56 53 11 52 29 14 37 87 43 79 19 52 49 14 69 88
 42 37 51 63 44  3 18 53 51 10  1 16 21 85  3 31 49 88 27 44 91 94 98 39
 84  7 52 22 97 11 30 83 94 61 19 47 28 63 32 28 38 61 22 31 95 55 81 66
 29 63  7 61 66 74 99 50 90 52 31 76 29 13 99 88 99 94 86  6 75 16 56 95
 54 68 25 32]
The percentile of the score 90 is: 87.5
Score at the 90th percentile is: 94.0</code></pre>
</div>
</div>
<p>As you can see, the values differ. This is important information that can be used to determine more than just the IQR.</p>
</section>
<section id="statistical-tests" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="statistical-tests"><span class="header-section-number">8.2.5</span> Statistical Tests</h3>
<p>Finally, statistical tests are arguably the most useful part of the scipy.stats package. The most important correlation function is the one-way ANOVA function. As a reminder, one-way ANOVA (analysis of variance) is used to compare the means of two or more independent groups, with the goal of determining if the means are significantly different. It is a parametric test that can be tedious and complicated to do by hand, so the scipy.stats functionality allows us to save a lot of time.</p>
<p>The initial set up is as follows:</p>
<pre><code>scipy.stats.f_oneway(*samples, axis=0)</code></pre>
<p>It takes parameters *samples, which is used to represent the two or more arrays that you input, and axis. Axis is defaulted to 0, but if you set it to another number that will be the axis of the arrays upon which the test is applied. The f_oneway function returns the F statistic and the p value of the test.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>precip_1895 <span class="op">=</span> np.array([<span class="fl">4.36</span>, <span class="fl">1.24</span>, <span class="fl">3.28</span>, <span class="fl">5.08</span>, <span class="fl">3.13</span>, <span class="fl">3.09</span>, <span class="fl">4.15</span>, <span class="fl">2.06</span>, <span class="fl">1.06</span>, <span class="fl">3.56</span>, <span class="fl">3.07</span>, <span class="fl">2.78</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>precip_1935 <span class="op">=</span> np.array([<span class="fl">4.19</span>, <span class="fl">2.88</span>, <span class="fl">2.57</span>, <span class="fl">2.54</span>, <span class="fl">1.96</span>, <span class="fl">4.59</span>, <span class="fl">4.42</span>, <span class="fl">2.89</span>, <span class="fl">6.69</span>, <span class="fl">4.63</span>, <span class="fl">5.15</span>, <span class="fl">1.89</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>precip_1975 <span class="op">=</span> np.array([<span class="fl">5.23</span>, <span class="fl">3.29</span>, <span class="fl">4.19</span>, <span class="fl">3.35</span>, <span class="fl">4.55</span>, <span class="fl">6.29</span>, <span class="fl">8.71</span>, <span class="fl">3.70</span>, <span class="fl">8.05</span>, <span class="fl">3.80</span>, <span class="fl">3.68</span>, <span class="fl">2.82</span>])</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>precip_2015 <span class="op">=</span> np.array([<span class="fl">4.43</span>, <span class="fl">2.18</span>, <span class="fl">4.55</span>, <span class="fl">2.67</span>, <span class="fl">1.21</span>, <span class="fl">8.12</span>, <span class="fl">3.68</span>, <span class="fl">2.26</span>, <span class="fl">3.60</span>, <span class="fl">4.02</span>, <span class="fl">2.30</span>, <span class="fl">4.84</span>])</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>F, p <span class="op">=</span> stats.f_oneway(precip_1895, precip_1935, precip_1975, precip_2015, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"F statistic is "</span> <span class="op">+</span> <span class="bu">str</span>(F))</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p value is "</span> <span class="op">+</span> <span class="bu">str</span>(p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F statistic is 2.3920989190674504
p value is 0.0813172700146769</code></pre>
</div>
</div>
<p>If we were to run the test with an alpha level of 0.05, then our p value is not in the rejection region and we would be unable to say that the mean of the precipitation levels for these 4 samples over the last 128 years are significantly different.</p>
<p>Now, if we wanted to check the difference between the first, second, and third months of each quarter, we could formulate the arrays differently:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>precip_1895_split <span class="op">=</span> np.array([[<span class="fl">4.36</span>, <span class="fl">1.24</span>, <span class="fl">3.28</span>], [<span class="fl">5.08</span>, <span class="fl">3.13</span>, <span class="fl">3.09</span>], [<span class="fl">4.15</span>, <span class="fl">2.06</span>, <span class="fl">1.06</span>], [<span class="fl">3.56</span>, <span class="fl">3.07</span>, <span class="fl">2.78</span>]])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>precip_1935_split <span class="op">=</span> np.array([[<span class="fl">4.19</span>, <span class="fl">2.88</span>, <span class="fl">2.57</span>], [<span class="fl">2.54</span>, <span class="fl">1.96</span>, <span class="fl">4.59</span>], [<span class="fl">4.42</span>, <span class="fl">2.89</span>, <span class="fl">6.69</span>], [<span class="fl">4.63</span>, <span class="fl">5.15</span>, <span class="fl">1.89</span>]])</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>precip_1975_split <span class="op">=</span> np.array([[<span class="fl">5.23</span>, <span class="fl">3.29</span>, <span class="fl">4.19</span>], [<span class="fl">3.35</span>, <span class="fl">4.55</span>, <span class="fl">6.29</span>], [<span class="fl">8.71</span>, <span class="fl">3.70</span>, <span class="fl">8.05</span>], [<span class="fl">3.80</span>, <span class="fl">3.68</span>, <span class="fl">2.82</span>]])</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>precip_2015_split <span class="op">=</span> np.array([[<span class="fl">4.43</span>, <span class="fl">2.18</span>, <span class="fl">4.55</span>], [<span class="fl">2.67</span>, <span class="fl">1.21</span>, <span class="fl">8.12</span>], [<span class="fl">3.68</span>, <span class="fl">2.26</span>, <span class="fl">3.60</span>], [<span class="fl">4.02</span>, <span class="fl">2.30</span>, <span class="fl">4.84</span>]])</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>F, p <span class="op">=</span> stats.f_oneway(precip_1895_split, precip_1935_split, precip_1975_split, precip_2015_split, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"F statistic is "</span> <span class="op">+</span> <span class="bu">str</span>(F))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p value is "</span> <span class="op">+</span> <span class="bu">str</span>(p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F statistic is [0.98374586 3.35080866 1.86738832]
p value is [0.43298199 0.05551278 0.18891543]</code></pre>
</div>
</div>
<p>As you can see, the second months of each quarter have the widest variety. This doesn’t tell us much information about this dataset, but it is in general a useful tool.</p>
<p>Finally, we can perform many sample tests related to the statistical distributions found earlier. Scipy.stats focuses primarily on t tests.</p>
<ul>
<li>One sample t-tests: scipy.stats.ttest_1samp</li>
</ul>
<p>This calculatutes the mean of one group and tests it against the null hypothesis mean. It is initialized with an array and the popmean to test against, and there is an optional parameter called alternative with options ‘two-sided’, ‘less’, and ‘greater’. The choice here will tell the program in which direction the hypothesis test has been set up. If the hypothesis test is merely checking for a difference between the mean of the data and popmean, use the default ‘two-sided’. If you want to check if your data’s mean is less than or greater than the given popmean, use ‘less’ or ‘greater’, respectively.</p>
<p>Let’s say we want to check if our 2015 monthly precipitation data is, on average, less than 5 inches. We can initialize the null and alternative hypothesis as <span class="math inline">\(H_0 = \mu_1 \geq \mu_2\)</span> and <span class="math inline">\(H_a = \mu_1 &lt; \mu_2\)</span>. If we want to check against 95% confidence, we will check with a p-value of 0.05.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stats.ttest_1samp(precip_2015, <span class="fl">5.0</span>, alternative<span class="op">=</span><span class="st">'less'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TtestResult(statistic=-2.5832078155485436, pvalue=0.012722209865812231, df=11)</code></pre>
</div>
</div>
<p>As you can see, our p-value is less than 0.05, so we can say with 95% confidence that the average monthly precipitation is less than 5.0 inches.</p>
<ul>
<li>Two sample, independent t-tests: scipy.stats.ttest_ind</li>
</ul>
<p>This test compares the means of two independent groups against each other. It is initialized with two arrays, and there is an optional parameter called alternative with options ‘two-sided’, ‘less’, and ‘greater’. The choice here will tell the program in which direction the hypothesis test has been set up. If the hypothesis test is merely checking for a difference between the means of the 2 data arrays, use the default ‘two-sided’. If you want to check if the first data mean is less than or greater than the second data mean, use ‘less’ or ‘greater’, respectively.</p>
<p>Let us now compare the 2015 monthly preciptation data against the 1895 data, and use two-sided to check if there is a difference. We can initialize our null and alternative hypothesis as: <span class="math inline">\(H_0 = \mu_1 = \mu_2\)</span> and <span class="math inline">\(H_a = \mu_1 \neq \mu_2\)</span>. If we want to check against 95% confidence, we will check with a p-value of 0.05.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stats.ttest_ind(precip_2015, precip_1895, alternative<span class="op">=</span><span class="st">'two-sided'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ttest_indResult(statistic=0.9344724605084526, pvalue=0.3602045183624706)</code></pre>
</div>
</div>
<p>As you can see, our p-value is greater than 0.05, so we cannot say with 95% confidence that the average monthly precipitation in 2015 is different than that in 1895.</p>
<ul>
<li>Kolmogorov-Smirnov test for goodness of fit: scipy.stats.ktest</li>
</ul>
<p>This one-sample test compares the distribution of a sample vs a given distribution. The test takes as input an array and a callable distribution’s cdf. An example is below.</p>
</section>
<section id="nyc-crash-data-examples" class="level3" data-number="8.2.6">
<h3 data-number="8.2.6" class="anchored" data-anchor-id="nyc-crash-data-examples"><span class="header-section-number">8.2.6</span> NYC crash data examples</h3>
<p>Let’s try and use the Kolmogorov-Smirnov test for goodness of fit for checking our data of crashes by hour.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/nyc_crashes_202301.csv'</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"HOUR"</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">"CRASH TIME"</span>].<span class="bu">str</span>.split(<span class="st">":"</span>).<span class="bu">str</span>[<span class="dv">0</span>])</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>plt.hist(df[<span class="st">'HOUR'</span>], bins<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-30-output-1.png" width="575" height="411"></p>
</div>
</div>
<p>As you can see, this sort of follows a chi-squared distribution. We can use the Kolmogorov-Smirnov test for goodness of fit to check how accurate this is.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> <span class="bu">getattr</span>(stats, <span class="st">'chi2'</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> dist.fit(df[<span class="st">'HOUR'</span>])</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'p value threshold: '</span> <span class="op">+</span> <span class="bu">str</span>(<span class="fl">1.36</span> <span class="op">/</span> math.sqrt(<span class="dv">7137</span>)))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stats.kstest(df[<span class="st">'HOUR'</span>], <span class="st">"chi2"</span>, (parameters[<span class="dv">0</span>], parameters[<span class="dv">1</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>p value threshold: 0.016098338682511194
KstestResult(statistic=0.9999999999949739, pvalue=0.0, statistic_location=23, statistic_sign=1)</code></pre>
</div>
</div>
<p>Unfortunately, our p value does not reach the threshold, so we have sufficient evidence that the distribution does not follow a chi2 one.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> stats.chi2.fit(df[<span class="st">'HOUR'</span>]) </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>plt.hist(df[<span class="st">'HOUR'</span>], bins<span class="op">=</span><span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">25</span>), density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Value'</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Relative frequency'</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Relative frequency histogram'</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># xmin, xmax = plt.xlim()</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># x = np.linspace(xmin, xmax, 100)</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># p = stats.chi2.pdf(x, parameters[0], parameters[1])</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>degrees_f <span class="op">=</span> <span class="dv">15</span><span class="co"># int(len(df['HOUR']) - 1)  # degrees of freedom</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(stats.chi2.ppf(<span class="fl">0.01</span>, degrees_f), stats.chi2.ppf(<span class="fl">0.99</span>, degrees_f), <span class="dv">100</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> stats.chi2.pdf(x, degrees_f)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'r-'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'chi2 pdf'</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">"Fit Values: </span><span class="sc">{:.2f}</span><span class="st"> and </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(parameters[<span class="dv">0</span>], parameters[<span class="dv">1</span>])</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>plt.title(title)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-32-output-1.png" width="597" height="449"></p>
</div>
</div>
<p>Clearly the fit is extremely loose, as evidenced by the dramatically low p-value found in the previous calculation, so we can once again dismiss the idea that our data follows a chi2 distribution.</p>
<p>We can also use statistical tests to draw some conclusions from the data. Let’s separate our huge dataset into smaller ones based upon borough to more easily split up the data.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Create new dataframes for each borough</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/nyc_crashes_202301.csv'</span>, index_col<span class="op">=</span><span class="st">'BOROUGH'</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>bronx <span class="op">=</span> df.loc[<span class="st">'BRONX'</span>]</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>staten_island <span class="op">=</span> df.loc[<span class="st">'STATEN ISLAND'</span>]</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>brooklyn <span class="op">=</span> df.loc[<span class="st">'BROOKLYN'</span>]</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>manhattan <span class="op">=</span> df.loc[<span class="st">'MANHATTAN'</span>]</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>queens <span class="op">=</span> df.loc[<span class="st">'QUEENS'</span>]</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Test to make sure it works</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(staten_island.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               CRASH DATE CRASH TIME  ZIP CODE   LATITUDE  LONGITUDE  \
BOROUGH                                                                
STATEN ISLAND  01/01/2023       6:40   10305.0  40.585240 -74.093414   
STATEN ISLAND  01/01/2023       1:18   10301.0  40.631510 -74.103874   
STATEN ISLAND  01/01/2023       2:00   10306.0  40.583366 -74.108350   
STATEN ISLAND  01/01/2023      13:00   10305.0  40.613980 -74.066050   
STATEN ISLAND  01/01/2023       7:10   10301.0  40.648228 -74.084500   

                             LOCATION    ON STREET NAME   CROSS STREET NAME  \
BOROUGH                                                                       
STATEN ISLAND  (40.58524, -74.093414)   HYLAN BOULEVARD         BUEL AVENUE   
STATEN ISLAND  (40.63151, -74.103874)               NaN                 NaN   
STATEN ISLAND  (40.583366, -74.10835)               NaN                 NaN   
STATEN ISLAND   (40.61398, -74.06605)               NaN                 NaN   
STATEN ISLAND   (40.648228, -74.0845)  RICHMOND TERRACE  SAINT PETERS PLACE   

                       OFF STREET NAME  NUMBER OF PERSONS INJURED  ...  \
BOROUGH                                                            ...   
STATEN ISLAND                      NaN                          1  ...   
STATEN ISLAND  504       KISSEL AVENUE                          0  ...   
STATEN ISLAND  1955      RICHMOND ROAD                          1  ...   
STATEN ISLAND     1201      BAY STREET                          0  ...   
STATEN ISLAND                      NaN                          0  ...   

               CONTRIBUTING FACTOR VEHICLE 2  CONTRIBUTING FACTOR VEHICLE 3  \
BOROUGH                                                                       
STATEN ISLAND                    Unspecified                            NaN   
STATEN ISLAND                    Unspecified                            NaN   
STATEN ISLAND                            NaN                            NaN   
STATEN ISLAND                    Unspecified                            NaN   
STATEN ISLAND                    Unspecified                            NaN   

               CONTRIBUTING FACTOR VEHICLE 4  CONTRIBUTING FACTOR VEHICLE 5  \
BOROUGH                                                                       
STATEN ISLAND                            NaN                            NaN   
STATEN ISLAND                            NaN                            NaN   
STATEN ISLAND                            NaN                            NaN   
STATEN ISLAND                            NaN                            NaN   
STATEN ISLAND                            NaN                            NaN   

               COLLISION_ID                  VEHICLE TYPE CODE 1  \
BOROUGH                                                            
STATEN ISLAND       4594485  Station Wagon/Sport Utility Vehicle   
STATEN ISLAND       4594804                                Sedan   
STATEN ISLAND       4594854                                  NaN   
STATEN ISLAND       4595229                                Sedan   
STATEN ISLAND       4603513                                Sedan   

               VEHICLE TYPE CODE 2 VEHICLE TYPE CODE 3 VEHICLE TYPE CODE 4  \
BOROUGH                                                                      
STATEN ISLAND                Sedan                 NaN                 NaN   
STATEN ISLAND                Sedan                 NaN                 NaN   
STATEN ISLAND                  NaN                 NaN                 NaN   
STATEN ISLAND                  NaN                 NaN                 NaN   
STATEN ISLAND                Sedan                 NaN                 NaN   

              VEHICLE TYPE CODE 5  
BOROUGH                            
STATEN ISLAND                 NaN  
STATEN ISLAND                 NaN  
STATEN ISLAND                 NaN  
STATEN ISLAND                 NaN  
STATEN ISLAND                 NaN  

[5 rows x 28 columns]</code></pre>
</div>
</div>
<p>Now, let’s perform an anova test to determine if the number of people injured on average differs between borough.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Get arrays for each borough</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>bronx_injuries <span class="op">=</span> bronx[<span class="st">'NUMBER_OF_PERSONS_INJURED'</span>].to_numpy()</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>si_injuries <span class="op">=</span> staten_island[<span class="st">'NUMBER_OF_PERSONS_INJURED'</span>].to_numpy()</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>brooklyn_injuries <span class="op">=</span> brooklyn[<span class="st">'NUMBER_OF_PERSONS_INJURED'</span>].to_numpy()</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>manhattan_injuries <span class="op">=</span> manhattan[<span class="st">'NUMBER_OF_PERSONS_INJURED'</span>].to_numpy()</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>queens_injuries <span class="op">=</span> queens[<span class="st">'NUMBER_OF_PERSONS_INJURED'</span>].to_numpy()</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Perform one way ANOVA</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>F, p <span class="op">=</span> stats.f_oneway(bronx_injuries, si_injuries, brooklyn_injuries, manhattan_injuries, queens_injuries, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"F statistic is "</span> <span class="op">+</span> <span class="bu">str</span>(F))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p value is "</span> <span class="op">+</span> <span class="bu">str</span>(p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we were to check with 95% confidence, we can say that the means of each borough do differ.</p>
<p>Finally, we can use a test to compare boroughs against each other to draw more meaningful conclusions.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stats.ttest_ind(bronx_injuries, brooklyn_injuries, alternative<span class="op">=</span><span class="st">'two-sided'</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean(bronx_injuries))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean(brooklyn_injuries))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see, our p value is too large to reject the null. Comparing the two means, we can see that they are similar so it makes sense why they are not rejected.</p>
</section>
<section id="references" class="level3" data-number="8.2.7">
<h3 data-number="8.2.7" class="anchored" data-anchor-id="references"><span class="header-section-number">8.2.7</span> REFERENCES</h3>
<p><a href="https://docs.scipy.org/doc/scipy/reference/stats.html">Scipy Offical Documentation</a></p>
<p><a href="https://www.geeksforgeeks.org/scipy-stats/">GeeksForGeeks Documentation</a></p>
<p><a href="https://www.tutorialspoint.com/scipy/scipy_stats.htm">TutorialsPoint Documentation</a></p>
<p><a href="https://www.javatpoint.com/scipy-stats">Javatpoint Documentation</a></p>
</section>
</section>
<section id="linear-model" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="linear-model"><span class="header-section-number">8.3</span> Linear Model</h2>
<p>Let’s simulate some data for illustrations.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>nobs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>ncov <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.random((nobs, ncov)) <span class="co"># Uniform over [0, 1)</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> np.repeat(<span class="dv">1</span>, ncov)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> np.dot(x, beta) <span class="op">+</span> np.random.normal(size <span class="op">=</span> nobs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check the shape of <code>y</code>:</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>y.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>(200,)</code></pre>
</div>
</div>
<p>Check the shape of <code>x</code>:</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>(200, 5)</code></pre>
</div>
</div>
<p>That is, the true linear regression model is <span class="math display">\[
y = 2 + x_1 + x_2 + x_3 + x_4 + x_5 + \epsilon.
\]</span></p>
<p>A regression model for the observed data can be fitted as</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sma</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>xmat <span class="op">=</span> sma.add_constant(x)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>mymod <span class="op">=</span> sma.OLS(y, xmat)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>myfit <span class="op">=</span> mymod.fit()</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>myfit.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>            <td>y</td>        <th>  R-squared:         </th> <td>   0.309</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.292</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   17.38</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 21 Mar 2023</td> <th>  Prob (F-statistic):</th> <td>3.31e-14</td>
</tr>
<tr>
  <th>Time:</th>                 <td>16:18:04</td>     <th>  Log-Likelihood:    </th> <td> -272.91</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   200</td>      <th>  AIC:               </th> <td>   557.8</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   194</td>      <th>  BIC:               </th> <td>   577.6</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
    <td></td>       <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th> <td>    1.8754</td> <td>    0.282</td> <td>    6.656</td> <td> 0.000</td> <td>    1.320</td> <td>    2.431</td>
</tr>
<tr>
  <th>x1</th>    <td>    1.1703</td> <td>    0.248</td> <td>    4.723</td> <td> 0.000</td> <td>    0.682</td> <td>    1.659</td>
</tr>
<tr>
  <th>x2</th>    <td>    0.8988</td> <td>    0.235</td> <td>    3.825</td> <td> 0.000</td> <td>    0.435</td> <td>    1.362</td>
</tr>
<tr>
  <th>x3</th>    <td>    0.9784</td> <td>    0.238</td> <td>    4.114</td> <td> 0.000</td> <td>    0.509</td> <td>    1.448</td>
</tr>
<tr>
  <th>x4</th>    <td>    1.3418</td> <td>    0.250</td> <td>    5.367</td> <td> 0.000</td> <td>    0.849</td> <td>    1.835</td>
</tr>
<tr>
  <th>x5</th>    <td>    0.6027</td> <td>    0.239</td> <td>    2.519</td> <td> 0.013</td> <td>    0.131</td> <td>    1.075</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td> 0.810</td> <th>  Durbin-Watson:     </th> <td>   1.978</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.667</td> <th>  Jarque-Bera (JB):  </th> <td>   0.903</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.144</td> <th>  Prob(JB):          </th> <td>   0.637</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.839</td> <th>  Cond. No.          </th> <td>    8.31</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p>Questions to review:</p>
<ul>
<li>How are the regression coefficients interpreted? Intercept?</li>
<li>Why does it make sense to center the covariates?</li>
</ul>
<p>Now we form a data frame with the variables</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> np.concatenate((y.reshape((nobs, <span class="dv">1</span>)), x), axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> df,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                  columns <span class="op">=</span> [<span class="st">"y"</span>] <span class="op">+</span> [<span class="st">"x"</span> <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                  ncov <span class="op">+</span> <span class="dv">1</span>)])</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 200 entries, 0 to 199
Data columns (total 6 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   y       200 non-null    float64
 1   x1      200 non-null    float64
 2   x2      200 non-null    float64
 3   x3      200 non-null    float64
 4   x4      200 non-null    float64
 5   x5      200 non-null    float64
dtypes: float64(6)
memory usage: 9.5 KB</code></pre>
</div>
</div>
<p>Let’s use a formula to specify the regression model as in R, and fit a robust linear model (<code>rlm</code>) instead of OLS. Note that the model specification and the function interface is similar to R.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mymod <span class="op">=</span> smf.rlm(formula <span class="op">=</span> <span class="st">"y ~ x1 + x2 + x3 + x4 + x5"</span>, data <span class="op">=</span> df)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>myfit <span class="op">=</span> mymod.fit()</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>myfit.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

<table class="simpletable">
<caption>Robust linear Model Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>          <td>y</td>        <th>  No. Observations:  </th> <td>   200</td>
</tr>
<tr>
  <th>Model:</th>                 <td>RLM</td>       <th>  Df Residuals:      </th> <td>   194</td>
</tr>
<tr>
  <th>Method:</th>               <td>IRLS</td>       <th>  Df Model:          </th> <td>     5</td>
</tr>
<tr>
  <th>Norm:</th>                <td>HuberT</td>      <th>                     </th>    <td> </td>  
</tr>
<tr>
  <th>Scale Est.:</th>            <td>mad</td>       <th>                     </th>    <td> </td>  
</tr>
<tr>
  <th>Cov Type:</th>              <td>H1</td>        <th>                     </th>    <td> </td>  
</tr>
<tr>
  <th>Date:</th>           <td>Tue, 21 Mar 2023</td> <th>                     </th>    <td> </td>  
</tr>
<tr>
  <th>Time:</th>               <td>16:18:04</td>     <th>                     </th>    <td> </td>  
</tr>
<tr>
  <th>No. Iterations:</th>        <td>16</td>        <th>                     </th>    <td> </td>  
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P&gt;|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    1.8353</td> <td>    0.294</td> <td>    6.246</td> <td> 0.000</td> <td>    1.259</td> <td>    2.411</td>
</tr>
<tr>
  <th>x1</th>        <td>    1.1254</td> <td>    0.258</td> <td>    4.355</td> <td> 0.000</td> <td>    0.619</td> <td>    1.632</td>
</tr>
<tr>
  <th>x2</th>        <td>    0.9664</td> <td>    0.245</td> <td>    3.944</td> <td> 0.000</td> <td>    0.486</td> <td>    1.447</td>
</tr>
<tr>
  <th>x3</th>        <td>    0.9995</td> <td>    0.248</td> <td>    4.029</td> <td> 0.000</td> <td>    0.513</td> <td>    1.486</td>
</tr>
<tr>
  <th>x4</th>        <td>    1.3275</td> <td>    0.261</td> <td>    5.091</td> <td> 0.000</td> <td>    0.816</td> <td>    1.839</td>
</tr>
<tr>
  <th>x5</th>        <td>    0.6768</td> <td>    0.250</td> <td>    2.712</td> <td> 0.007</td> <td>    0.188</td> <td>    1.166</td>
</tr>
</tbody></table><br><br>If the model instance has been used for another fit with different fit parameters, then the fit options might not be the correct ones anymore .
</div>
</div>
<p>For model diagnostics, one can check residual plots.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>myOlsFit <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">"y ~ x1 + x2 + x3 + x4 + x5"</span>, data <span class="op">=</span> df).fit()</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">## residual versus x1; can do the same for other covariates</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sma.graphics.plot_regress_exog(myOlsFit, <span class="st">'x1'</span>, fig<span class="op">=</span>fig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eval_env: 1</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="stats_files/figure-html/cell-42-output-2.png" width="566" height="570"></p>
</div>
</div>
<p>See more on <a href="https://www.statsmodels.org/stable/stats.html#residual-diagnostics-and-specification-tests">residual diagnostics and specification tests</a>.</p>
</section>
<section id="generalized-linear-regression" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="generalized-linear-regression"><span class="header-section-number">8.4</span> Generalized Linear Regression</h2>
<p>A linear regression model cannot be applied to presence/absence or count data.</p>
<p>Binary or count data need to be modeled under a generlized framework. Consider a binary or count variable <span class="math inline">\(Y\)</span> with possible covariates <span class="math inline">\(X\)</span>. A generalized model describes a transformation <span class="math inline">\(g\)</span> of the conditional mean <span class="math inline">\(E[Y | X]\)</span> by a linear predictor <span class="math inline">\(X^{\top}\beta\)</span>. That is <span class="math display">\[
g( E[Y | X] ) = X^{\top} \beta.
\]</span> The transformation <span class="math inline">\(g\)</span> is known as the link function.</p>
<p>For logistic regression with binary outcomes, the link function is the logit function <span class="math display">\[
g(u) = \log \frac{u}{1 - u}, \quad u \in (0, 1).
\]</span></p>
<p>What is the interpretation of the regression coefficients in a logistic regression? Intercept?</p>
<p>A logistic regression can be fit with <code>statsmodels.api.glm</code>.</p>
<p>Let’s generate some binary data first by dichotomizing existing variables.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.genmod <span class="im">as</span> smg</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> x.dot([<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>]) <span class="op">-</span> <span class="dv">5</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> smg.families.links.Logit().inverse(eta)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"yb"</span>] <span class="op">=</span> np.random.binomial(<span class="dv">1</span>, p, p.size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit a logistic regression for <code>y1b</code>.</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mylogistic <span class="op">=</span> smf.glm(formula <span class="op">=</span> <span class="st">'yb ~ x1 + x2 + x3 + x4 + x5'</span>, data <span class="op">=</span> df,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                     family <span class="op">=</span> smg.families.Binomial())</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>mylfit <span class="op">=</span> mylogistic.fit()</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>mylfit.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<table class="simpletable">
<caption>Generalized Linear Model Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>          <td>yb</td>        <th>  No. Observations:  </th>  <td>   200</td> 
</tr>
<tr>
  <th>Model:</th>                  <td>GLM</td>       <th>  Df Residuals:      </th>  <td>   194</td> 
</tr>
<tr>
  <th>Model Family:</th>        <td>Binomial</td>     <th>  Df Model:          </th>  <td>     5</td> 
</tr>
<tr>
  <th>Link Function:</th>         <td>Logit</td>      <th>  Scale:             </th> <td>  1.0000</td>
</tr>
<tr>
  <th>Method:</th>                <td>IRLS</td>       <th>  Log-Likelihood:    </th> <td> -110.80</td>
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 21 Mar 2023</td> <th>  Deviance:          </th> <td>  221.61</td>
</tr>
<tr>
  <th>Time:</th>                <td>16:18:06</td>     <th>  Pearson chi2:      </th>  <td>  196.</td> 
</tr>
<tr>
  <th>No. Iterations:</th>          <td>4</td>        <th>  Pseudo R-squ. (CS):</th>  <td>0.2410</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P&gt;|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   -4.6982</td> <td>    0.820</td> <td>   -5.728</td> <td> 0.000</td> <td>   -6.306</td> <td>   -3.091</td>
</tr>
<tr>
  <th>x1</th>        <td>    2.1654</td> <td>    0.618</td> <td>    3.505</td> <td> 0.000</td> <td>    0.955</td> <td>    3.376</td>
</tr>
<tr>
  <th>x2</th>        <td>    1.1788</td> <td>    0.579</td> <td>    2.035</td> <td> 0.042</td> <td>    0.044</td> <td>    2.314</td>
</tr>
<tr>
  <th>x3</th>        <td>    1.5921</td> <td>    0.587</td> <td>    2.713</td> <td> 0.007</td> <td>    0.442</td> <td>    2.742</td>
</tr>
<tr>
  <th>x4</th>        <td>    2.2310</td> <td>    0.630</td> <td>    3.539</td> <td> 0.000</td> <td>    0.995</td> <td>    3.466</td>
</tr>
<tr>
  <th>x5</th>        <td>    2.5496</td> <td>    0.598</td> <td>    4.263</td> <td> 0.000</td> <td>    1.377</td> <td>    3.722</td>
</tr>
</tbody></table>
</div>
</div>
<p>If we treat <code>y1b</code> as count data, a Poisson regression can be fitted.</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>myPois <span class="op">=</span> smf.glm(formula <span class="op">=</span> <span class="st">'yb ~ x1 + x2 + x3 + x4 + x5'</span>, data <span class="op">=</span> df,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                 family <span class="op">=</span> smg.families.Poisson())</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>mypfit <span class="op">=</span> myPois.fit()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>mypfit.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

<table class="simpletable">
<caption>Generalized Linear Model Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>          <td>yb</td>        <th>  No. Observations:  </th>  <td>   200</td> 
</tr>
<tr>
  <th>Model:</th>                  <td>GLM</td>       <th>  Df Residuals:      </th>  <td>   194</td> 
</tr>
<tr>
  <th>Model Family:</th>         <td>Poisson</td>     <th>  Df Model:          </th>  <td>     5</td> 
</tr>
<tr>
  <th>Link Function:</th>          <td>Log</td>       <th>  Scale:             </th> <td>  1.0000</td>
</tr>
<tr>
  <th>Method:</th>                <td>IRLS</td>       <th>  Log-Likelihood:    </th> <td> -161.33</td>
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 21 Mar 2023</td> <th>  Deviance:          </th> <td>  112.66</td>
</tr>
<tr>
  <th>Time:</th>                <td>16:18:06</td>     <th>  Pearson chi2:      </th>  <td>  89.6</td> 
</tr>
<tr>
  <th>No. Iterations:</th>          <td>5</td>        <th>  Pseudo R-squ. (CS):</th>  <td>0.1071</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P&gt;|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   -2.4529</td> <td>    0.435</td> <td>   -5.644</td> <td> 0.000</td> <td>   -3.305</td> <td>   -1.601</td>
</tr>
<tr>
  <th>x1</th>        <td>    0.7638</td> <td>    0.361</td> <td>    2.117</td> <td> 0.034</td> <td>    0.057</td> <td>    1.471</td>
</tr>
<tr>
  <th>x2</th>        <td>    0.3698</td> <td>    0.330</td> <td>    1.121</td> <td> 0.262</td> <td>   -0.277</td> <td>    1.017</td>
</tr>
<tr>
  <th>x3</th>        <td>    0.5396</td> <td>    0.345</td> <td>    1.562</td> <td> 0.118</td> <td>   -0.137</td> <td>    1.217</td>
</tr>
<tr>
  <th>x4</th>        <td>    0.7895</td> <td>    0.368</td> <td>    2.144</td> <td> 0.032</td> <td>    0.068</td> <td>    1.511</td>
</tr>
<tr>
  <th>x5</th>        <td>    0.9477</td> <td>    0.352</td> <td>    2.691</td> <td> 0.007</td> <td>    0.257</td> <td>    1.638</td>
</tr>
</tbody></table>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./descr.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./visual.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>